import Foundation
import NaturalLanguage

enum SupportedLanguage: String, CaseIterable, Identifiable {
    case zhCN = "zh-CN"
    case en
    case ja
    case ko
    case es
    case fr

    var id: String { rawValue }

    static func fromConfig(_ code: String) -> SupportedLanguage {
        SupportedLanguage(rawValue: code) ?? .zhCN
    }

    var nlLanguage: NLLanguage {
        switch self {
        case .zhCN:
            return .simplifiedChinese
        case .en:
            return .english
        case .ja:
            return .japanese
        case .ko:
            return .korean
        case .es:
            return .spanish
        case .fr:
            return .french
        }
    }
}

struct I18nCatalog {
    static let shared = I18nCatalog()

    private let entries: [SupportedLanguage: [String: String]] = [
        .zhCN: [
            "app.welcomeTitle": "欢迎使用 AI Hub",
            "app.welcomeSubtitle": "点击左侧图标选择 AI 助手",
            "home.action.addSite": "添加站点",
            "home.action.settings": "打开设置",
            "home.section.recent": "最近保存的对话",
            "home.section.empty": "暂无已保存对话",
            "top.newTab": "新建标签",
            "top.summarize": "总结",
            "top.summarizing": "总结中",
            "top.save": "保存",
            "top.home": "首页",
            "top.split": "分屏",
            "top.multiSession": "多会话",
            "top.closeTab": "关闭标签",
            "tab.loadFailed": "加载失败",
            "tab.loadTimeout": "加载超时",
            "top.splitNeedTwoTabs": "请先创建第二个标签页（新建标签），再开启分屏。",
            "settings.title": "设置",
            "settings.done": "完成",
            "settings.cancel": "取消",
            "settings.tabs.appearance": "外观",
            "settings.tabs.layout": "布局",
            "settings.tabs.language": "语言",
            "settings.tabs.ai": "AI",
            "settings.tabs.advanced": "高级",
            "settings.language": "语言",
            "settings.languageHint": "界面语言将影响“总结”输出语言。",
            "settings.darkTheme": "深色主题",
            "settings.sidebarExpand": "侧边栏展开",
            "settings.sidebarWidth": "侧边栏宽度",
            "settings.sidebarIconSize": "侧边栏图标大小",
            "settings.sidebarTextSize": "侧边栏文字大小",
            "settings.summaryPromptTemplate": "总结提示词模板（全局）",
            "settings.summaryPromptHint": "可用变量：{language}、{text}",
            "settings.resetToDefault": "恢复默认",
            "settings.save": "保存",
            "settings.saveApiSettings": "保存 API 设置",
            "settings.savePromptTemplate": "保存模板",
            "settings.embeddingModel": "Embedding 模型",
            "settings.searchMode": "搜索模式",
            "settings.searchMode.keyword": "关键字",
            "settings.searchMode.semanticOffline": "语义（离线）",
            "settings.searchMode.semanticOnline": "语义（在线）",
            "settings.clearKey": "清空 Key",
            "settings.aiApiSaved": "AI API 设置已保存",
            "settings.apiKeyCleared": "已清空 API Key",
            "settings.clearApiKeyConfirm": "确认清空 API Key？清空后自动总结将不可用。",
            "settings.resetNavTitle": "重置导航栏",
            "settings.resetNavContent": "将清空：置顶、最近、排序。不会删除站点本身。",
            "settings.resetNavConfirm": "重置",
            "settings.resetNavButton": "重置导航栏",
            "settings.resetNavToast": "已重置",
            "settings.resetNavError": "重置导航栏失败",
            "settings.clearHistoryTitle": "清除保存历史",
            "settings.clearHistoryContent": "将删除所有已保存的对话内容，无法恢复。",
            "settings.clearHistoryButton": "清除保存历史",
            "settings.clearHistoryConfirm": "清除",
            "settings.clearHistorySuccess": "已清除保存历史",
            "siteSettings.title": "站点设置",
            "siteSettings.name": "站点名称",
            "siteSettings.url": "站点 URL",
            "siteSettings.icon": "图标",
            "siteSettings.summaryPromptOverride": "总结提示词模板（覆盖）",
            "siteSettings.useGlobalPrompt": "使用全局模板",
            "sidebar.searchPlaceholder": "搜索站点（名称/URL/对话历史）",
            "sidebar.sectionPinned": "置顶",
            "sidebar.sectionRecent": "最近",
            "sidebar.sectionSaved": "已保存",
            "sidebar.menu.siteSettings": "站点设置…",
            "sidebar.menu.pin": "置顶",
            "sidebar.menu.unpin": "取消置顶",
            "sidebar.menu.refresh": "刷新页面",
            "sidebar.menu.clearCache": "清除缓存",
            "sidebar.menu.removeSite": "删除站点",
            "sidebar.addSite": "添加站点",
            "sidebar.settings": "设置",
            "sidebar.collapse": "收起",
            "sidebar.expand": "展开",
            "sidebar.light": "浅色",
            "sidebar.dark": "深色",
            "sidebar.switchToLight": "切换到浅色主题",
            "sidebar.switchToDark": "切换到深色主题",
            "addSite.title": "添加自定义站点",
            "addSite.add": "添加",
            "summary.title": "总结",
            "summary.placeholder": "总结结果会出现在这里",
            "summary.copyPrefix": "上下文（可迁移）：",
            "summary.nextQuestion": "接下来我想问：<在此写问题>",
            "summary.copySuccess": "已复制到剪贴板",
            "summary.copyFail": "复制失败（可能缺少剪贴板权限）",
            "saved.title": "已保存内容",
            "saved.site": "站点",
            "saved.url": "网址",
            "saved.savedAt": "保存时间",
            "saved.copySuccess": "已复制到剪贴板",
            "saved.copyFail": "复制失败（可能缺少剪贴板权限）",
            "search.noActiveTab": "没有可保存的标签页",
            "search.noVisibleContent": "当前页面没有可保存的内容",
            "search.embeddingFailed": "生成向量失败",
            "search.embeddingUnavailable": "离线向量不可用",
            "search.embeddingMissingKey": "缺少 API Key",
            "search.embeddingMissingModel": "缺少 Embedding 模型",
            "search.saveSuccess": "保存完成",
            "search.loadFailed": "加载保存内容失败",
            "common.close": "关闭",
            "common.copyToClipboard": "复制到剪贴板",
            "common.loadConfigFailed": "加载配置失败",
            "common.siteNotFound": "站点不存在",
            "common.fillNameUrl": "请填写站点名称和 URL",
            "common.refreshFailed": "刷新失败",
            "common.clearCacheFailed": "清除缓存失败",
            "context.title": "上下文（按项目）",
            "context.selectProject": "选择项目",
            "context.newProject": "新建项目",
            "context.deleteProject": "删除项目",
            "context.saveProject": "保存",
            "context.autoSummarize": "自动总结",
            "context.copy": "复制到剪贴板",
            "context.projectName": "项目名称",
            "context.notes": "项目笔记",
            "context.summary": "可迁移摘要",
            "context.createProject": "新建项目",
            "context.create": "创建",
            "context.deleteConfirmTitle": "删除项目",
            "context.deleteConfirmBody": "确认删除该项目？内容将无法恢复。",
            "context.deleted": "已删除项目",
            "context.created": "已创建项目",
            "context.saved": "已保存",
            "context.summarizeNeedsNotes": "请先粘贴对话/素材到“项目笔记”",
            "context.notesPlaceholder": "把多轮对话/背景资料粘贴到这里，然后点“自动总结”。",
            "context.summaryPlaceholder": "自动总结结果会出现在这里（也可手动编辑）。",
            "context.copySuccess": "已复制到剪贴板"
        ],
        .en: [
            "app.welcomeTitle": "Welcome to AI Hub",
            "app.welcomeSubtitle": "Select an AI assistant from the left sidebar",
            "home.action.addSite": "Add site",
            "home.action.settings": "Open settings",
            "home.section.recent": "Recent saved conversations",
            "home.section.empty": "No saved conversations yet",
            "top.newTab": "New Tab",
            "top.summarize": "Summarize",
            "top.summarizing": "Summarizing",
            "top.save": "Save",
            "top.home": "Home",
            "top.split": "Split",
            "top.multiSession": "Multi-session",
            "top.closeTab": "Close tab",
            "tab.loadFailed": "Load failed",
            "tab.loadTimeout": "Timed out",
            "top.splitNeedTwoTabs": "Create another tab first (New Tab), then enable split view.",
            "settings.title": "Settings",
            "settings.done": "Done",
            "settings.cancel": "Cancel",
            "settings.tabs.appearance": "Appearance",
            "settings.tabs.layout": "Layout",
            "settings.tabs.language": "Language",
            "settings.tabs.ai": "AI",
            "settings.tabs.advanced": "Advanced",
            "settings.language": "Language",
            "settings.languageHint": "UI language also controls the summary output language.",
            "settings.darkTheme": "Dark theme",
            "settings.sidebarExpand": "Sidebar expanded",
            "settings.sidebarWidth": "Sidebar width",
            "settings.sidebarIconSize": "Sidebar icon size",
            "settings.sidebarTextSize": "Sidebar text size",
            "settings.summaryPromptTemplate": "Summary prompt template (global)",
            "settings.summaryPromptHint": "Variables: {language}, {text}",
            "settings.resetToDefault": "Reset to default",
            "settings.save": "Save",
            "settings.saveApiSettings": "Save API settings",
            "settings.savePromptTemplate": "Save template",
            "settings.embeddingModel": "Embedding model",
            "settings.searchMode": "Search mode",
            "settings.searchMode.keyword": "Keyword",
            "settings.searchMode.semanticOffline": "Semantic (offline)",
            "settings.searchMode.semanticOnline": "Semantic (online)",
            "settings.clearKey": "Clear key",
            "settings.aiApiSaved": "AI API settings saved",
            "settings.apiKeyCleared": "API key cleared",
            "settings.clearApiKeyConfirm": "Clear API key? Auto-summarize will be unavailable.",
            "settings.resetNavTitle": "Reset sidebar",
            "settings.resetNavContent": "This will clear pinned, recent and ordering. Sites will not be deleted.",
            "settings.resetNavConfirm": "Reset",
            "settings.resetNavButton": "Reset sidebar",
            "settings.resetNavToast": "Reset done",
            "settings.resetNavError": "Reset failed",
            "settings.clearHistoryTitle": "Clear saved history",
            "settings.clearHistoryContent": "This will delete all saved conversations and cannot be undone.",
            "settings.clearHistoryButton": "Clear saved history",
            "settings.clearHistoryConfirm": "Clear",
            "settings.clearHistorySuccess": "Saved history cleared",
            "siteSettings.title": "Site Settings",
            "siteSettings.name": "Name",
            "siteSettings.url": "URL",
            "siteSettings.icon": "Icon",
            "siteSettings.summaryPromptOverride": "Summary prompt template (override)",
            "siteSettings.useGlobalPrompt": "Use global template",
            "sidebar.searchPlaceholder": "Search sites (name/URL/Chat History)",
            "sidebar.sectionPinned": "Pinned",
            "sidebar.sectionRecent": "Recent",
            "sidebar.sectionSaved": "Saved",
            "sidebar.menu.siteSettings": "Site settings…",
            "sidebar.menu.pin": "Pin",
            "sidebar.menu.unpin": "Unpin",
            "sidebar.menu.refresh": "Reload",
            "sidebar.menu.clearCache": "Clear cache",
            "sidebar.menu.removeSite": "Remove site",
            "sidebar.addSite": "Add site",
            "sidebar.settings": "Settings",
            "sidebar.collapse": "Collapse",
            "sidebar.expand": "Expand",
            "sidebar.light": "Light",
            "sidebar.dark": "Dark",
            "sidebar.switchToLight": "Switch to light theme",
            "sidebar.switchToDark": "Switch to dark theme",
            "addSite.title": "Add custom site",
            "addSite.add": "Add",
            "summary.title": "Summary",
            "summary.placeholder": "The summary will appear here",
            "summary.copyPrefix": "Portable context:",
            "summary.nextQuestion": "Next question: <type your question here>",
            "summary.copySuccess": "Copied to clipboard",
            "summary.copyFail": "Copy failed (clipboard permission may be missing)",
            "saved.title": "Saved Content",
            "saved.site": "Site",
            "saved.url": "URL",
            "saved.savedAt": "Saved at",
            "saved.copySuccess": "Copied to clipboard",
            "saved.copyFail": "Copy failed (clipboard permission may be missing)",
            "search.noActiveTab": "No active tab to save",
            "search.noVisibleContent": "No visible content to save",
            "search.embeddingFailed": "Embedding failed",
            "search.embeddingUnavailable": "Offline embeddings unavailable",
            "search.embeddingMissingKey": "Missing API key",
            "search.embeddingMissingModel": "Missing embedding model",
            "search.saveSuccess": "Saved",
            "search.loadFailed": "Failed to load saved content",
            "common.close": "Close",
            "common.copyToClipboard": "Copy to clipboard",
            "common.loadConfigFailed": "Failed to load config",
            "common.siteNotFound": "Site not found",
            "common.fillNameUrl": "Please fill in name and URL",
            "common.refreshFailed": "Refresh failed",
            "common.clearCacheFailed": "Failed to clear cache",
            "context.title": "Project Context",
            "context.selectProject": "Select project",
            "context.newProject": "New project",
            "context.deleteProject": "Delete project",
            "context.saveProject": "Save",
            "context.autoSummarize": "Auto summarize",
            "context.copy": "Copy to clipboard",
            "context.projectName": "Project name",
            "context.notes": "Project notes",
            "context.summary": "Portable summary",
            "context.createProject": "Create project",
            "context.create": "Create",
            "context.deleteConfirmTitle": "Delete project",
            "context.deleteConfirmBody": "Delete this project? This cannot be undone.",
            "context.deleted": "Project deleted",
            "context.created": "Project created",
            "context.saved": "Saved",
            "context.summarizeNeedsNotes": "Paste notes into Project Notes first",
            "context.notesPlaceholder": "Paste conversation or background here, then click Auto summarize.",
            "context.summaryPlaceholder": "Auto summary will appear here (you can edit).",
            "context.copySuccess": "Copied to clipboard"
        ],
        .ja: [
            "app.welcomeTitle": "AI Hubへようこそ",
            "app.welcomeSubtitle": "左のサイドバーからAIを選択してください",
            "home.action.addSite": "サイトを追加",
            "home.action.settings": "設定を開く",
            "home.section.recent": "最近保存した会話",
            "home.section.empty": "保存済みの会話がありません",
            "top.newTab": "新しいタブ",
            "top.summarize": "要約",
            "top.summarizing": "要約中",
            "top.save": "保存",
            "top.home": "ホーム",
            "top.split": "分割",
            "top.multiSession": "マルチセッション",
            "top.closeTab": "タブを閉じる",
            "tab.loadFailed": "読み込み失敗",
            "tab.loadTimeout": "タイムアウト",
            "top.splitNeedTwoTabs": "先に2つ目のタブを作成してから分割を有効にしてください。",
            "settings.title": "設定",
            "settings.done": "完了",
            "settings.cancel": "キャンセル",
            "settings.tabs.appearance": "外観",
            "settings.tabs.layout": "レイアウト",
            "settings.tabs.language": "言語",
            "settings.tabs.ai": "AI",
            "settings.tabs.advanced": "詳細",
            "settings.language": "言語",
            "settings.languageHint": "UI言語は要約の出力言語にも影響します。",
            "settings.darkTheme": "ダークテーマ",
            "settings.sidebarExpand": "サイドバー展開",
            "settings.sidebarWidth": "サイドバー幅",
            "settings.sidebarIconSize": "サイドバーのアイコンサイズ",
            "settings.sidebarTextSize": "サイドバーの文字サイズ",
            "settings.summaryPromptTemplate": "要約プロンプト（全体）",
            "settings.summaryPromptHint": "変数: {language}, {text}",
            "settings.resetToDefault": "既定に戻す",
            "settings.save": "保存",
            "settings.saveApiSettings": "AI API 設定を保存",
            "settings.savePromptTemplate": "テンプレートを保存",
            "settings.embeddingModel": "Embedding モデル",
            "settings.searchMode": "検索モード",
            "settings.searchMode.keyword": "キーワード",
            "settings.searchMode.semanticOffline": "意味（オフライン）",
            "settings.searchMode.semanticOnline": "意味（オンライン）",
            "settings.clearKey": "キーを消去",
            "settings.aiApiSaved": "AI API 設定を保存しました",
            "settings.apiKeyCleared": "API キーを消去しました",
            "settings.clearApiKeyConfirm": "API キーを消去しますか？自動要約が使えなくなります。",
            "settings.resetNavTitle": "サイドバーをリセット",
            "settings.resetNavContent": "ピン留め/最近/並び順をクリアします。サイト自体は削除されません。",
            "settings.resetNavConfirm": "リセット",
            "settings.resetNavButton": "サイドバーをリセット",
            "settings.resetNavToast": "リセットしました",
            "settings.resetNavError": "リセットに失敗しました",
            "settings.clearHistoryTitle": "保存履歴を削除",
            "settings.clearHistoryContent": "保存済みの会話をすべて削除します。元に戻せません。",
            "settings.clearHistoryButton": "保存履歴を削除",
            "settings.clearHistoryConfirm": "削除",
            "settings.clearHistorySuccess": "保存履歴を削除しました",
            "siteSettings.title": "サイト設定",
            "siteSettings.name": "名前",
            "siteSettings.url": "URL",
            "siteSettings.icon": "アイコン",
            "siteSettings.summaryPromptOverride": "要約プロンプト（上書き）",
            "siteSettings.useGlobalPrompt": "全体テンプレートを使用",
            "sidebar.searchPlaceholder": "サイト検索（名前/URL）",
            "sidebar.sectionPinned": "ピン留め",
            "sidebar.sectionRecent": "最近",
            "sidebar.sectionSaved": "保存済み",
            "sidebar.menu.siteSettings": "サイト設定…",
            "sidebar.menu.pin": "ピン留め",
            "sidebar.menu.unpin": "ピン解除",
            "sidebar.menu.refresh": "再読み込み",
            "sidebar.menu.clearCache": "キャッシュを消去",
            "sidebar.menu.removeSite": "サイトを削除",
            "sidebar.addSite": "サイト追加",
            "sidebar.settings": "設定",
            "sidebar.collapse": "折りたたむ",
            "sidebar.expand": "展開",
            "sidebar.light": "ライト",
            "sidebar.dark": "ダーク",
            "sidebar.switchToLight": "ライトテーマに切替",
            "sidebar.switchToDark": "ダークテーマに切替",
            "addSite.title": "カスタムサイトを追加",
            "addSite.add": "追加",
            "summary.title": "要約",
            "summary.placeholder": "要約結果はここに表示されます",
            "summary.copyPrefix": "移植可能なコンテキスト:",
            "summary.nextQuestion": "次の質問: <ここに入力>",
            "summary.copySuccess": "クリップボードにコピーしました",
            "summary.copyFail": "コピーに失敗しました",
            "saved.title": "保存済み内容",
            "saved.site": "サイト",
            "saved.url": "URL",
            "saved.savedAt": "保存日時",
            "saved.copySuccess": "クリップボードにコピーしました",
            "saved.copyFail": "コピーに失敗しました（権限がない可能性があります）",
            "search.noActiveTab": "保存できるタブがありません",
            "search.noVisibleContent": "保存できる表示内容がありません",
            "search.embeddingFailed": "埋め込みの生成に失敗しました",
            "search.embeddingUnavailable": "オフライン埋め込みは利用できません",
            "search.embeddingMissingKey": "API キーがありません",
            "search.embeddingMissingModel": "埋め込みモデルがありません",
            "search.saveSuccess": "保存しました",
            "search.loadFailed": "保存内容の読み込みに失敗しました",
            "common.close": "閉じる",
            "common.copyToClipboard": "クリップボードにコピー",
            "common.loadConfigFailed": "設定の読み込みに失敗しました",
            "common.siteNotFound": "サイトが見つかりません",
            "common.fillNameUrl": "名前とURLを入力してください",
            "common.refreshFailed": "更新に失敗しました",
            "common.clearCacheFailed": "キャッシュの削除に失敗しました",
            "context.title": "プロジェクトコンテキスト",
            "context.selectProject": "プロジェクトを選択",
            "context.newProject": "新規プロジェクト",
            "context.deleteProject": "プロジェクトを削除",
            "context.saveProject": "保存",
            "context.autoSummarize": "自動要約",
            "context.copy": "クリップボードにコピー",
            "context.projectName": "プロジェクト名",
            "context.notes": "プロジェクトノート",
            "context.summary": "移植可能な要約",
            "context.createProject": "新規プロジェクト",
            "context.create": "作成",
            "context.deleteConfirmTitle": "プロジェクトを削除",
            "context.deleteConfirmBody": "このプロジェクトを削除しますか？元に戻せません。",
            "context.deleted": "プロジェクトを削除しました",
            "context.created": "プロジェクトを作成しました",
            "context.saved": "保存しました",
            "context.summarizeNeedsNotes": "まずプロジェクトノートに貼り付けてください",
            "context.notesPlaceholder": "会話や背景を貼り付けて自動要約を押します。",
            "context.summaryPlaceholder": "自動要約結果がここに表示されます。",
            "context.copySuccess": "クリップボードにコピーしました"
        ],
        .ko: [
            "app.welcomeTitle": "AI Hub에 오신 것을 환영합니다",
            "app.welcomeSubtitle": "왼쪽 사이드바에서 AI를 선택하세요",
            "home.action.addSite": "사이트 추가",
            "home.action.settings": "설정 열기",
            "home.section.recent": "최근 저장된 대화",
            "home.section.empty": "저장된 대화가 없습니다",
            "top.newTab": "새 탭",
            "top.summarize": "요약",
            "top.summarizing": "요약 중",
            "top.save": "저장",
            "top.home": "홈",
            "top.split": "분할",
            "top.multiSession": "멀티 세션",
            "top.closeTab": "탭 닫기",
            "tab.loadFailed": "로드 실패",
            "tab.loadTimeout": "시간 초과",
            "top.splitNeedTwoTabs": "두 번째 탭을 만든 후 분할을 활성화하세요.",
            "settings.title": "설정",
            "settings.done": "완료",
            "settings.cancel": "취소",
            "settings.tabs.appearance": "외관",
            "settings.tabs.layout": "레이아웃",
            "settings.tabs.language": "언어",
            "settings.tabs.ai": "AI",
            "settings.tabs.advanced": "고급",
            "settings.language": "언어",
            "settings.languageHint": "UI 언어는 요약 출력 언어에도 영향을 줍니다.",
            "settings.darkTheme": "다크 테마",
            "settings.sidebarExpand": "사이드바 펼침",
            "settings.sidebarWidth": "사이드바 너비",
            "settings.sidebarIconSize": "사이드바 아이콘 크기",
            "settings.sidebarTextSize": "사이드바 글자 크기",
            "settings.summaryPromptTemplate": "요약 프롬프트 템플릿(전역)",
            "settings.summaryPromptHint": "변수: {language}, {text}",
            "settings.resetToDefault": "기본값으로",
            "settings.save": "저장",
            "settings.saveApiSettings": "API 설정 저장",
            "settings.savePromptTemplate": "템플릿 저장",
            "settings.embeddingModel": "임베딩 모델",
            "settings.searchMode": "검색 모드",
            "settings.searchMode.keyword": "키워드",
            "settings.searchMode.semanticOffline": "의미(오프라인)",
            "settings.searchMode.semanticOnline": "의미(온라인)",
            "settings.clearKey": "키 지우기",
            "settings.aiApiSaved": "API 설정이 저장되었습니다",
            "settings.apiKeyCleared": "API 키가 삭제되었습니다",
            "settings.clearApiKeyConfirm": "API 키를 삭제할까요? 자동 요약을 사용할 수 없습니다.",
            "settings.resetNavTitle": "사이드바 초기화",
            "settings.resetNavContent": "핀/최근/순서를 초기화합니다. 사이트는 삭제되지 않습니다.",
            "settings.resetNavConfirm": "초기화",
            "settings.resetNavButton": "사이드바 초기화",
            "settings.resetNavToast": "초기화 완료",
            "settings.resetNavError": "초기화 실패",
            "settings.clearHistoryTitle": "저장 기록 삭제",
            "settings.clearHistoryContent": "저장된 대화를 모두 삭제합니다. 되돌릴 수 없습니다.",
            "settings.clearHistoryButton": "저장 기록 삭제",
            "settings.clearHistoryConfirm": "삭제",
            "settings.clearHistorySuccess": "저장 기록이 삭제되었습니다",
            "siteSettings.title": "사이트 설정",
            "siteSettings.name": "이름",
            "siteSettings.url": "URL",
            "siteSettings.icon": "아이콘",
            "siteSettings.summaryPromptOverride": "요약 프롬프트(재정의)",
            "siteSettings.useGlobalPrompt": "전역 템플릿 사용",
            "sidebar.searchPlaceholder": "사이트 검색(이름/URL)",
            "sidebar.sectionPinned": "고정",
            "sidebar.sectionRecent": "최근",
            "sidebar.sectionSaved": "저장됨",
            "sidebar.menu.siteSettings": "사이트 설정…",
            "sidebar.menu.pin": "고정",
            "sidebar.menu.unpin": "고정 해제",
            "sidebar.menu.refresh": "새로고침",
            "sidebar.menu.clearCache": "캐시 삭제",
            "sidebar.menu.removeSite": "사이트 삭제",
            "sidebar.addSite": "사이트 추가",
            "sidebar.settings": "설정",
            "sidebar.collapse": "접기",
            "sidebar.expand": "펼치기",
            "sidebar.light": "라이트",
            "sidebar.dark": "다크",
            "sidebar.switchToLight": "라이트 테마로 전환",
            "sidebar.switchToDark": "다크 테마로 전환",
            "addSite.title": "사용자 정의 사이트 추가",
            "addSite.add": "추가",
            "summary.title": "요약",
            "summary.placeholder": "요약이 여기에 표시됩니다",
            "summary.copyPrefix": "이식 가능한 컨텍스트:",
            "summary.nextQuestion": "다음 질문: <여기에 입력>",
            "summary.copySuccess": "클립보드에 복사됨",
            "summary.copyFail": "복사 실패",
            "saved.title": "저장된 내용",
            "saved.site": "사이트",
            "saved.url": "URL",
            "saved.savedAt": "저장 시간",
            "saved.copySuccess": "클립보드에 복사됨",
            "saved.copyFail": "복사 실패(클립보드 권한 부족 가능)",
            "search.noActiveTab": "저장할 탭이 없습니다",
            "search.noVisibleContent": "저장할 표시 내용이 없습니다",
            "search.embeddingFailed": "임베딩 생성 실패",
            "search.embeddingUnavailable": "오프라인 임베딩을 사용할 수 없습니다",
            "search.embeddingMissingKey": "API 키가 없습니다",
            "search.embeddingMissingModel": "임베딩 모델이 없습니다",
            "search.saveSuccess": "저장됨",
            "search.loadFailed": "저장된 내용을 불러오지 못했습니다",
            "common.close": "닫기",
            "common.copyToClipboard": "클립보드에 복사",
            "common.loadConfigFailed": "설정을 불러올 수 없습니다",
            "common.siteNotFound": "사이트를 찾을 수 없습니다",
            "common.fillNameUrl": "이름과 URL을 입력하세요",
            "common.refreshFailed": "새로고침 실패",
            "common.clearCacheFailed": "캐시 삭제 실패",
            "context.title": "프로젝트 컨텍스트",
            "context.selectProject": "프로젝트 선택",
            "context.newProject": "새 프로젝트",
            "context.deleteProject": "프로젝트 삭제",
            "context.saveProject": "저장",
            "context.autoSummarize": "자동 요약",
            "context.copy": "클립보드에 복사",
            "context.projectName": "프로젝트 이름",
            "context.notes": "프로젝트 노트",
            "context.summary": "이식 가능한 요약",
            "context.createProject": "새 프로젝트",
            "context.create": "생성",
            "context.deleteConfirmTitle": "프로젝트 삭제",
            "context.deleteConfirmBody": "이 프로젝트를 삭제할까요? 복구할 수 없습니다.",
            "context.deleted": "프로젝트가 삭제되었습니다",
            "context.created": "프로젝트가 생성되었습니다",
            "context.saved": "저장됨",
            "context.summarizeNeedsNotes": "프로젝트 노트에 먼저 붙여넣으세요",
            "context.notesPlaceholder": "대화나 배경을 붙여넣고 자동 요약을 누르세요.",
            "context.summaryPlaceholder": "자동 요약 결과가 여기에 표시됩니다.",
            "context.copySuccess": "클립보드에 복사됨"
        ],
        .es: [
            "app.welcomeTitle": "Bienvenido a AI Hub",
            "app.welcomeSubtitle": "Selecciona un asistente de IA en la barra lateral",
            "home.action.addSite": "Agregar sitio",
            "home.action.settings": "Abrir configuración",
            "home.section.recent": "Conversaciones guardadas recientes",
            "home.section.empty": "No hay conversaciones guardadas",
            "top.newTab": "Nueva pestaña",
            "top.summarize": "Resumir",
            "top.summarizing": "Resumiendo",
            "top.save": "Guardar",
            "top.home": "Inicio",
            "top.split": "Dividir",
            "top.multiSession": "Multi-sesión",
            "top.closeTab": "Cerrar pestaña",
            "tab.loadFailed": "Carga fallida",
            "tab.loadTimeout": "Tiempo agotado",
            "top.splitNeedTwoTabs": "Crea otra pestaña primero y luego activa la vista dividida.",
            "settings.title": "Configuración",
            "settings.done": "Listo",
            "settings.cancel": "Cancelar",
            "settings.tabs.appearance": "Apariencia",
            "settings.tabs.layout": "Diseño",
            "settings.tabs.language": "Idioma",
            "settings.tabs.ai": "IA",
            "settings.tabs.advanced": "Avanzado",
            "settings.language": "Idioma",
            "settings.languageHint": "El idioma de la interfaz también controla el idioma del resumen.",
            "settings.darkTheme": "Tema oscuro",
            "settings.sidebarExpand": "Barra lateral expandida",
            "settings.sidebarWidth": "Ancho de la barra lateral",
            "settings.sidebarIconSize": "Tamaño de iconos de la barra lateral",
            "settings.sidebarTextSize": "Tamaño de texto de la barra lateral",
            "settings.summaryPromptTemplate": "Plantilla de prompt de resumen (global)",
            "settings.summaryPromptHint": "Variables: {language}, {text}",
            "settings.resetToDefault": "Restablecer",
            "settings.save": "Guardar",
            "settings.saveApiSettings": "Guardar configuración de API",
            "settings.savePromptTemplate": "Guardar plantilla",
            "settings.embeddingModel": "Modelo de embedding",
            "settings.searchMode": "Modo de búsqueda",
            "settings.searchMode.keyword": "Palabra clave",
            "settings.searchMode.semanticOffline": "Semántico (sin conexión)",
            "settings.searchMode.semanticOnline": "Semántico (en línea)",
            "settings.clearKey": "Borrar clave",
            "settings.aiApiSaved": "Configuración de API guardada",
            "settings.apiKeyCleared": "Clave API borrada",
            "settings.clearApiKeyConfirm": "¿Borrar la clave API? El resumen automático no estará disponible.",
            "settings.resetNavTitle": "Restablecer barra lateral",
            "settings.resetNavContent": "Esto limpiará fijados, recientes y orden. No eliminará sitios.",
            "settings.resetNavConfirm": "Restablecer",
            "settings.resetNavButton": "Restablecer barra lateral",
            "settings.resetNavToast": "Restablecido",
            "settings.resetNavError": "Error al restablecer",
            "settings.clearHistoryTitle": "Eliminar historial guardado",
            "settings.clearHistoryContent": "Se eliminarán todas las conversaciones guardadas. No se puede deshacer.",
            "settings.clearHistoryButton": "Eliminar historial guardado",
            "settings.clearHistoryConfirm": "Eliminar",
            "settings.clearHistorySuccess": "Historial guardado eliminado",
            "siteSettings.title": "Configuración del sitio",
            "siteSettings.name": "Nombre",
            "siteSettings.url": "URL",
            "siteSettings.icon": "Icono",
            "siteSettings.summaryPromptOverride": "Plantilla de resumen (anular)",
            "siteSettings.useGlobalPrompt": "Usar plantilla global",
            "sidebar.searchPlaceholder": "Buscar sitios (nombre/URL)",
            "sidebar.sectionPinned": "Fijados",
            "sidebar.sectionRecent": "Recientes",
            "sidebar.sectionSaved": "Guardado",
            "sidebar.menu.siteSettings": "Configuración del sitio…",
            "sidebar.menu.pin": "Fijar",
            "sidebar.menu.unpin": "Desfijar",
            "sidebar.menu.refresh": "Recargar",
            "sidebar.menu.clearCache": "Limpiar caché",
            "sidebar.menu.removeSite": "Eliminar sitio",
            "sidebar.addSite": "Agregar sitio",
            "sidebar.settings": "Configuración",
            "sidebar.collapse": "Colapsar",
            "sidebar.expand": "Expandir",
            "sidebar.light": "Claro",
            "sidebar.dark": "Oscuro",
            "sidebar.switchToLight": "Cambiar a tema claro",
            "sidebar.switchToDark": "Cambiar a tema oscuro",
            "addSite.title": "Agregar sitio personalizado",
            "addSite.add": "Agregar",
            "summary.title": "Resumen",
            "summary.placeholder": "El resumen aparecerá aquí",
            "summary.copyPrefix": "Contexto portable:",
            "summary.nextQuestion": "Siguiente pregunta: <escribe aquí>",
            "summary.copySuccess": "Copiado al portapapeles",
            "summary.copyFail": "Error al copiar",
            "saved.title": "Contenido guardado",
            "saved.site": "Sitio",
            "saved.url": "URL",
            "saved.savedAt": "Guardado el",
            "saved.copySuccess": "Copiado al portapapeles",
            "saved.copyFail": "Error al copiar (puede faltar permiso del portapapeles)",
            "search.noActiveTab": "No hay una pestaña activa para guardar",
            "search.noVisibleContent": "No hay contenido visible para guardar",
            "search.embeddingFailed": "Error al generar el embedding",
            "search.embeddingUnavailable": "Embedding sin conexión no disponible",
            "search.embeddingMissingKey": "Falta la clave API",
            "search.embeddingMissingModel": "Falta el modelo de embedding",
            "search.saveSuccess": "Guardado",
            "search.loadFailed": "No se pudo cargar el contenido guardado",
            "common.close": "Cerrar",
            "common.copyToClipboard": "Copiar al portapapeles",
            "common.loadConfigFailed": "No se pudo cargar la configuración",
            "common.siteNotFound": "Sitio no encontrado",
            "common.fillNameUrl": "Completa nombre y URL",
            "common.refreshFailed": "Error al recargar",
            "common.clearCacheFailed": "Error al limpiar caché",
            "context.title": "Contexto del proyecto",
            "context.selectProject": "Seleccionar proyecto",
            "context.newProject": "Nuevo proyecto",
            "context.deleteProject": "Eliminar proyecto",
            "context.saveProject": "Guardar",
            "context.autoSummarize": "Resumir automáticamente",
            "context.copy": "Copiar al portapapeles",
            "context.projectName": "Nombre del proyecto",
            "context.notes": "Notas del proyecto",
            "context.summary": "Resumen portable",
            "context.createProject": "Crear proyecto",
            "context.create": "Crear",
            "context.deleteConfirmTitle": "Eliminar proyecto",
            "context.deleteConfirmBody": "¿Eliminar este proyecto? No se puede deshacer.",
            "context.deleted": "Proyecto eliminado",
            "context.created": "Proyecto creado",
            "context.saved": "Guardado",
            "context.summarizeNeedsNotes": "Pega notas en Notas del proyecto primero",
            "context.notesPlaceholder": "Pega conversación o contexto y pulsa Resumir automáticamente.",
            "context.summaryPlaceholder": "El resumen automático aparecerá aquí.",
            "context.copySuccess": "Copiado al portapapeles"
        ],
        .fr: [
            "app.welcomeTitle": "Bienvenue dans AI Hub",
            "app.welcomeSubtitle": "Sélectionnez un assistant IA dans la barre latérale",
            "home.action.addSite": "Ajouter un site",
            "home.action.settings": "Ouvrir les paramètres",
            "home.section.recent": "Conversations enregistrées récentes",
            "home.section.empty": "Aucune conversation enregistrée",
            "top.newTab": "Nouvel onglet",
            "top.summarize": "Résumer",
            "top.summarizing": "Résumé en cours",
            "top.save": "Enregistrer",
            "top.home": "Accueil",
            "top.split": "Fractionner",
            "top.multiSession": "Multi-session",
            "top.closeTab": "Fermer l'onglet",
            "tab.loadFailed": "Échec du chargement",
            "tab.loadTimeout": "Délai dépassé",
            "top.splitNeedTwoTabs": "Créez un deuxième onglet avant d'activer la vue fractionnée.",
            "settings.title": "Paramètres",
            "settings.done": "Terminé",
            "settings.cancel": "Annuler",
            "settings.tabs.appearance": "Apparence",
            "settings.tabs.layout": "Disposition",
            "settings.tabs.language": "Langue",
            "settings.tabs.ai": "IA",
            "settings.tabs.advanced": "Avancé",
            "settings.language": "Langue",
            "settings.languageHint": "La langue de l'interface contrôle aussi la langue du résumé.",
            "settings.darkTheme": "Thème sombre",
            "settings.sidebarExpand": "Barre latérale étendue",
            "settings.sidebarWidth": "Largeur de la barre latérale",
            "settings.sidebarIconSize": "Taille des icônes de la barre latérale",
            "settings.sidebarTextSize": "Taille du texte de la barre latérale",
            "settings.summaryPromptTemplate": "Modèle de prompt de résumé (global)",
            "settings.summaryPromptHint": "Variables: {language}, {text}",
            "settings.resetToDefault": "Réinitialiser",
            "settings.save": "Enregistrer",
            "settings.saveApiSettings": "Enregistrer les paramètres API",
            "settings.savePromptTemplate": "Enregistrer le modèle",
            "settings.embeddingModel": "Modèle d'embedding",
            "settings.searchMode": "Mode de recherche",
            "settings.searchMode.keyword": "Mot-clé",
            "settings.searchMode.semanticOffline": "Sémantique (hors ligne)",
            "settings.searchMode.semanticOnline": "Sémantique (en ligne)",
            "settings.clearKey": "Effacer la clé",
            "settings.aiApiSaved": "Paramètres API enregistrés",
            "settings.apiKeyCleared": "Clé API effacée",
            "settings.clearApiKeyConfirm": "Effacer la clé API ? Le résumé automatique sera indisponible.",
            "settings.resetNavTitle": "Réinitialiser la barre latérale",
            "settings.resetNavContent": "Cela effacera épinglés, récents et ordre. Les sites ne seront pas supprimés.",
            "settings.resetNavConfirm": "Réinitialiser",
            "settings.resetNavButton": "Réinitialiser la barre latérale",
            "settings.resetNavToast": "Réinitialisation terminée",
            "settings.resetNavError": "Échec de la réinitialisation",
            "settings.clearHistoryTitle": "Effacer l'historique enregistré",
            "settings.clearHistoryContent": "Supprime toutes les conversations enregistrées. Cette action est irréversible.",
            "settings.clearHistoryButton": "Effacer l'historique enregistré",
            "settings.clearHistoryConfirm": "Effacer",
            "settings.clearHistorySuccess": "Historique enregistré effacé",
            "siteSettings.title": "Paramètres du site",
            "siteSettings.name": "Nom",
            "siteSettings.url": "URL",
            "siteSettings.icon": "Icône",
            "siteSettings.summaryPromptOverride": "Modèle de résumé (remplacement)",
            "siteSettings.useGlobalPrompt": "Utiliser le modèle global",
            "sidebar.searchPlaceholder": "Rechercher des sites (nom/URL)",
            "sidebar.sectionPinned": "Épinglés",
            "sidebar.sectionRecent": "Récents",
            "sidebar.sectionSaved": "Enregistré",
            "sidebar.menu.siteSettings": "Paramètres du site…",
            "sidebar.menu.pin": "Épingler",
            "sidebar.menu.unpin": "Désépingler",
            "sidebar.menu.refresh": "Recharger",
            "sidebar.menu.clearCache": "Vider le cache",
            "sidebar.menu.removeSite": "Supprimer le site",
            "sidebar.addSite": "Ajouter un site",
            "sidebar.settings": "Paramètres",
            "sidebar.collapse": "Réduire",
            "sidebar.expand": "Développer",
            "sidebar.light": "Clair",
            "sidebar.dark": "Sombre",
            "sidebar.switchToLight": "Passer au thème clair",
            "sidebar.switchToDark": "Passer au thème sombre",
            "addSite.title": "Ajouter un site personnalisé",
            "addSite.add": "Ajouter",
            "summary.title": "Résumé",
            "summary.placeholder": "Le résumé apparaîtra ici",
            "summary.copyPrefix": "Contexte portable :",
            "summary.nextQuestion": "Question suivante : <écrivez ici>",
            "summary.copySuccess": "Copié dans le presse-papiers",
            "summary.copyFail": "Échec de la copie",
            "saved.title": "Contenu enregistré",
            "saved.site": "Site",
            "saved.url": "URL",
            "saved.savedAt": "Enregistré le",
            "saved.copySuccess": "Copié dans le presse-papiers",
            "saved.copyFail": "Échec de la copie (permission du presse-papiers manquante)",
            "search.noActiveTab": "Aucun onglet actif à enregistrer",
            "search.noVisibleContent": "Aucun contenu visible à enregistrer",
            "search.embeddingFailed": "Échec de l'embedding",
            "search.embeddingUnavailable": "Embedding hors ligne indisponible",
            "search.embeddingMissingKey": "Clé API manquante",
            "search.embeddingMissingModel": "Modèle d'embedding manquant",
            "search.saveSuccess": "Enregistré",
            "search.loadFailed": "Échec du chargement du contenu enregistré",
            "common.close": "Fermer",
            "common.copyToClipboard": "Copier dans le presse-papiers",
            "common.loadConfigFailed": "Échec du chargement de la configuration",
            "common.siteNotFound": "Site introuvable",
            "common.fillNameUrl": "Veuillez saisir le nom et l'URL",
            "common.refreshFailed": "Échec du rechargement",
            "common.clearCacheFailed": "Échec de la suppression du cache",
            "context.title": "Contexte du projet",
            "context.selectProject": "Sélectionner un projet",
            "context.newProject": "Nouveau projet",
            "context.deleteProject": "Supprimer le projet",
            "context.saveProject": "Enregistrer",
            "context.autoSummarize": "Résumer automatiquement",
            "context.copy": "Copier dans le presse-papiers",
            "context.projectName": "Nom du projet",
            "context.notes": "Notes du projet",
            "context.summary": "Résumé portable",
            "context.createProject": "Créer un projet",
            "context.create": "Créer",
            "context.deleteConfirmTitle": "Supprimer le projet",
            "context.deleteConfirmBody": "Supprimer ce projet ? Cette action est irréversible.",
            "context.deleted": "Projet supprimé",
            "context.created": "Projet créé",
            "context.saved": "Enregistré",
            "context.summarizeNeedsNotes": "Collez d'abord des notes dans Notes du projet",
            "context.notesPlaceholder": "Collez la conversation puis cliquez sur Résumer automatiquement.",
            "context.summaryPlaceholder": "Le résumé automatique apparaîtra ici.",
            "context.copySuccess": "Copié dans le presse-papiers"
        ]
    ]

    func t(_ key: String, language: SupportedLanguage) -> String {
        if let value = entries[language]?[key] {
            return value
        }
        if let fallback = entries[.en]?[key] {
            return fallback
        }
        return key
    }

    func languageLabel(for code: String) -> String {
        switch code {
        case "zh-CN", "zh":
            return "中文"
        case "en", "en-US", "en-GB":
            return "English"
        case "ja", "ja-JP":
            return "日本語"
        case "ko", "ko-KR":
            return "한국어"
        case "es", "es-ES", "es-AR":
            return "Español"
        case "fr", "fr-FR":
            return "Français"
        default:
            return "English"
        }
    }
}
